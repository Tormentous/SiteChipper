<!DOCTYPE html>
<html>
    <head>
        <title>Polls - Coolbrador</title>
        <link rel="stylesheet" href="styles.css"/>
    </head>
    <body>
        <div id="shared-header"></div>

        <div class="container bodytext-section mt-4">
            <h1 class="section-header">Report an Issue with a Coolbrador Product or Moderator</h1>
        </div>

        <!-- Tabs -->
        <div class="container mt-3">
            <ul class="nav nav-tabs" id="issueTabs" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="issues-tab" data-toggle="tab" href="#issues" role="tab">Issues</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="mutinies-tab" data-toggle="tab" href="#mutinies" role="tab">Mutinies</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="ideas-tab" data-toggle="tab" href="#ideas" role="tab">Ideas</a>
                </li>
            </ul>

            <div class="tab-content mt-3">
                <div class="tab-pane fade show active" id="issues" role="tabpanel">
                    <section class="container bodytext-section">
                        <h1>We resolve issues transparently via open community votes, ensuring fairness for all.</h1>
                        <!-- Existing issues content here -->
                    </section>
                </div>
                <div class="tab-pane fade" id="mutinies" role="tabpanel">
                    <section class="container bodytext-section">
                        <h1>Mutinies</h1>
                        <p>Community proposals to remove or replace moderators.</p>
                    </section>
                </div>
                <div class="tab-pane fade" id="ideas" role="tabpanel">
                    <section class="container bodytext-section">
                        <h1>Ideas & Suggestions</h1>
                        <p>Share your ideas for new features or improvements.</p>
                    </section>
                </div>
            </div>
        </div>

        <div id="shared-footer"></div>

<script>
	function updateUserProfile() {
	  const loggedIn = localStorage.getItem("loggedIn") === "true";
	  const userId = localStorage.getItem("currentUserId");

	  if (!loggedIn || !userId) {
		document.querySelectorAll("#userSection, #userSectionMobile").forEach(el => {
		  if (el) el.innerHTML = `<a href="/login.html" style="color:#4a9eff;font-weight:bold;">Login</a>`;
		});
		return;
	  }

	  const user = JSON.parse(localStorage.getItem(`user_${userId}`)) || {};
	  const pfp = user.profilePicture || "/users/default/pfp.jpg";
	  const username = user.username || "User";

	  // Desktop
	  const desk = document.getElementById("userSection");
	  if (desk) {
		desk.innerHTML = `
		  <a href="/users/${userId}/profile.html" style="display:flex;align-items:center;gap:10px;color:white;text-decoration:none;">
			<img src="${pfp}" alt="${username}" style="width:40px;height:40px;border-radius:50%;object-fit:cover;border:0px solid #fff;box-shadow:0 2px 8px rgba(0,0,0,0.3);">
			<span style="font-weight:bold;">${username}</span>
		  </a>`;
	  }

	  // Mobile
	  const mob = document.getElementById("userSectionMobile");
	  if (mob) {
		mob.innerHTML = `
		  <a href="/users/${userId}/profile.html">
			<img src="${pfp}" alt="${username}" style="width:40px;height:40px;border-radius:50%;object-fit:cover;border:0px solid #fff;box-shadow:0 2px 8px rgba(0,0,0,0.4);">
		  </a>`;
	  }
	}

	// Load header + footer, then update profile
	document.addEventListener("DOMContentLoaded", () => {
	  fetch("../shared/header.html")
		.then(r => r.text())
		.then(html => {
		  document.getElementById("shared-header").innerHTML = html;
		  updateUserProfile(); // â† runs after header loads
		});

	  fetch("../shared/footer.html")
		.then(r => r.text())
		.then(html => document.getElementById("shared-footer").innerHTML = html);

	  // Keep updated across tabs
	  window.addEventListener("storage", updateUserProfile);
	});
</script>
    </body>
</html>
